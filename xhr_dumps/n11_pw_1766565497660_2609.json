{"url": "https://www.n11.com/genelWithoutClear/footerscript-118165262?ajax=true", "json": {"inventoryIdForSeo": 118165262, "seoCmsContent": "", "seoText": "", "inventoryNameForSeo": "footer-optimization-script", "seoMetaData": {"alternate": "https://m.n11.com/genel/footer-optimization-script-", "canonical": "https://www.n11.com/genel/footer-optimization-script-118165262", "deepLinkModel": null, "description": "footer-optimization-script - n11", "image": "https://n11scdn2-im.akamaized.net/a1/640/20/09/21/84/44/56/86/11/27/49/86/67/01624004745729654692.jpg", "noIndex": false, "redirectUrl": "", "robots": "", "title": "footer-optimization-script - n11", "valid": true}, "html": "(function() {\r\n  const allowedValues = [\"DISC11836_V1\", \"DISC11836_V2\", \"DISC12068_V1\", \"DISC12068_V2\", \"DISC11880_V1\", \"DISC11880_V2\", \"DISC11880_V3\", \"DISC12038_ORG\", \"DISC12038_V1\"];\r\n  const cookies = document.cookie.split(\";\");\r\n\r\n  cookies.forEach(cookie => {\r\n    const [rawName, rawValue] = cookie.split(\"=\");\r\n    const name = rawName.trim();\r\n    const value = rawValue ? rawValue.trim() : \"\";\r\n\r\n    if (name === \"Optimization\" && !allowedValues.includes(value)) {\r\n      document.cookie = `${name}=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/`;\r\n    }\r\n  });\r\n\r\n\r\n\r\n// REVIEW\r\n\r\nconst currentUrl = window.location.href;\r\n\r\nconst url = new URL(currentUrl);\r\nconst promotion = url.searchParams.get(\"promotions\");\r\n\r\nif (promotion) {\r\n  console.log(\"Mobil review URL – promotions parametresi mevcut, promList değişmedi\");\r\n} else {\r\n  localStorage.setItem(\"promList\", \"0\");\r\n  console.log(\"promList sıfırlandı\");\r\n}\r\n\r\n\r\n// REVIEW\r\n\r\n\r\n})();\r\nfunction masterTestEngineInit() {\r\n  // ====== MASTER TEST ENGINE ======\r\n  class ABTestEngine {\r\n    constructor() {\r\n      this.config = {\r\n        isCookiePermit: this.checkCookiePermission(),\r\n        pageName: window.dataLayer?.filter((item) => item.pageName)?.[0]?.pageName || \"\",\r\n        loginStatus: window.dataLayer?.filter((item) => item.loginStatus)?.[0]?.loginStatus,\r\n        opt_preview: new URL(window.location.href).searchParams.get(\"opt\"),\r\n      };\r\n      this.tests = new Map();\r\n      this.activeCookie = this.getCookie(\"Optimization\");\r\n    }\r\n    // ... ABTestEngine methods ...\r\n    checkCookiePermission() {\r\n      const dataLayerPermission = window.dataLayer?.filter((item) => item.categories)?.at(-1)?.categories?.marketing;\r\n      if (dataLayerPermission !== undefined) {\r\n        return dataLayerPermission;\r\n      }\r\n      if (typeof OnetrustActiveGroups !== \"undefined\") {\r\n        const hasMarketingConsent = OnetrustActiveGroups.includes(\"C0004\");\r\n        return hasMarketingConsent;\r\n      }\r\n      const consentCookie = this.getCookie(\"cookie-consent\") || this.getCookie(\"consent-preferences\");\r\n      if (consentCookie) {\r\n        try {\r\n          const consentData = JSON.parse(consentCookie);\r\n          const marketingConsent = consentData.marketing || consentData.analytics || false;\r\n          return marketingConsent;\r\n        } catch (e) {}\r\n      }\r\n      if (window.cookieConsent && typeof window.cookieConsent === \"object\") {\r\n        const marketingConsent = window.cookieConsent.marketing || window.cookieConsent.analytics || false;\r\n        return marketingConsent;\r\n      }\r\n      if (typeof gtag !== \"undefined\") {\r\n        return false;\r\n      }\r\n      return false;\r\n    }\r\n    setCookie(name, value, days) {\r\n      try {\r\n        if (!this.config.isCookiePermit) return false;\r\n        let cookie = `${name}=${value};path=/;SameSite=Strict;`;\r\n        if (days) {\r\n          const date = new Date();\r\n          date.setTime(date.getTime() + days * 24 * 60 * 60 * 1000);\r\n          cookie += `expires=${date.toUTCString()};`;\r\n        }\r\n        if (location.protocol === \"https:\") cookie += \"Secure;\";\r\n        document.cookie = cookie;\r\n        return true;\r\n      } catch (e) {\r\n        console.error(\"Cookie set error:\", e);\r\n        return false;\r\n      }\r\n    }\r\n    getCookie(name) {\r\n      const nameEQ = `${name}=`;\r\n      const cookies = document.cookie.split(\";\");\r\n      for (let cookie of cookies) {\r\n        cookie = cookie.trim();\r\n        if (cookie.indexOf(nameEQ) === 0) {\r\n          return cookie.substring(nameEQ.length);\r\n        }\r\n      }\r\n      return \"\";\r\n    }\r\n    clearCookie(name) {\r\n      this.setCookie(name, \"\", -1);\r\n    }\r\n    pushDataLayer(variation) {\r\n      //ORIGINAL\r\n      //window.dataLayer = window.dataLayer || [];\r\n      //window.dataLayer.push({ event: \"InternalAB\", Variation: variation });\r\n\r\n      // Cookie Kontrolü QR Test için\r\n      window.dataLayer = window.dataLayer || [];\r\n      function getCookie(name) {\r\n        const value = `; ${document.cookie}`;\r\n        const parts = value.split(`; ${name}=`);\r\n        if (parts.length === 2) {\r\n          return parts.pop().split(\";\").shift();\r\n        }\r\n        return null;\r\n      }\r\n\r\n      const isOpen = getCookie(\"isOpen\") === \"true\";\r\n\r\n      window.dataLayer = window.dataLayer || [];\r\n      window.dataLayer.push({\r\n        event: \"InternalAB\",\r\n        Variation: variation,\r\n        ...(isOpen ? { disableQrTest: \"disabled\" } : {}),\r\n      });\r\n      // Cookie Kontrolü QR Test için\r\n    }\r\n    triggerHotjar(variation) {\r\n      if (typeof hj !== \"undefined\") {\r\n        hj(\"trigger\", [variation]);\r\n        hj(\"tagRecording\", [variation]);\r\n      }\r\n    }\r\n    weightedRandom(weights) {\r\n      const totalWeight = weights.reduce((sum, weight) => sum + weight, 0);\r\n      let randomNum = Math.random() * totalWeight;\r\n      let cumulativeWeight = 0;\r\n      for (let i = 0; i < weights.length; i++) {\r\n        cumulativeWeight += weights[i];\r\n        if (randomNum <= cumulativeWeight) {\r\n          return i;\r\n        }\r\n      }\r\n      return weights.length - 1;\r\n    }\r\n    registerTest(testConfig) {\r\n      const test = new ABTest(testConfig, this);\r\n      this.tests.set(testConfig.id, test);\r\n      return test;\r\n    }\r\n    getUserActiveTest() {\r\n      const activeVariations = this.getActiveVariations();\r\n      if (activeVariations.length === 0) {\r\n        return null;\r\n      }\r\n      for (let [testId, test] of this.tests) {\r\n        const hasVariationInTest = activeVariations.some((variation) => test.config.versions.includes(variation));\r\n        if (hasVariationInTest) {\r\n          const userVariation = activeVariations.find((variation) => test.config.versions.includes(variation));\r\n          return {\r\n            testId: testId,\r\n            variation: userVariation,\r\n            test: test,\r\n          };\r\n        }\r\n      }\r\n      return null;\r\n    }\r\n    runTests() {\r\n      const activeTest = this.getUserActiveTest();\r\n      if (activeTest) {\r\n        const conditionsStatus = activeTest.test.checkConditions();\r\n        if (conditionsStatus) {\r\n          activeTest.test.executeVariation(activeTest.variation);\r\n        }\r\n        return;\r\n      }\r\n      const eligibleTests = [];\r\n      this.tests.forEach((test) => {\r\n        const runStatus = test.canRun();\r\n        if (runStatus.canRun && !runStatus.useExisting) {\r\n          eligibleTests.push(test);\r\n        }\r\n      });\r\n      if (eligibleTests.length === 0) {\r\n        return;\r\n      }\r\n      const selectedTest = eligibleTests[Math.floor(Math.random() * eligibleTests.length)];\r\n      selectedTest.checkAndRun();\r\n    }\r\n    getActiveVariations() {\r\n      return this.activeCookie ? this.activeCookie.split(\",\") : [];\r\n    }\r\n    setActiveVariation(variation) {\r\n      if (!this.config.isCookiePermit) {\r\n        return false;\r\n      }\r\n      const current = this.getActiveVariations();\r\n      if (!current.includes(variation)) {\r\n        current.push(variation);\r\n        const success = this.setCookie(\"Optimization\", current.join(\",\"), 365);\r\n        if (success) {\r\n          this.activeCookie = current.join(\",\");\r\n        }\r\n        return success;\r\n      }\r\n      return true;\r\n    }\r\n  }\r\n  class ABTest {\r\n    constructor(config, engine) {\r\n      this.id = config.id;\r\n      this.engine = engine;\r\n      this.config = {\r\n        id: config.id,\r\n        versions: config.versions || [],\r\n        weights: config.weights || [],\r\n        conditions: config.conditions || {},\r\n        trafficPercentage: config.trafficPercentage || 1.0,\r\n        variations: config.variations || {},\r\n      };\r\n    }\r\n    checkConditions() {\r\n      const conditions = this.config.conditions;\r\n      if (conditions.requireCookiePermit) {\r\n        if (!this.engine.config.isCookiePermit) {\r\n          return false;\r\n        }\r\n      }\r\n      if (conditions.loginStatus && conditions.loginStatus.length > 0) {\r\n        if (!conditions.loginStatus.includes(this.engine.config.loginStatus)) {\r\n          return false;\r\n        }\r\n      }\r\n      if (typeof conditions.isThere === \"undefined\" || conditions.isThere === false || conditions.isThere === 0) {\r\n        return false;\r\n      }\r\n      if (conditions.pages && conditions.pages.length > 0) {\r\n        if (!conditions.pages.includes(this.engine.config.pageName)) {\r\n          return false;\r\n        }\r\n      }\r\n      if (conditions.screenSize) {\r\n        const mediaQuery = window.matchMedia(conditions.screenSize);\r\n        if (!mediaQuery.matches) {\r\n          return false;\r\n        }\r\n      }\r\n      if (conditions.hostname) {\r\n        if (window.location.hostname !== conditions.hostname) {\r\n          return false;\r\n        }\r\n      }\r\n      if (conditions.previewParam) {\r\n        if (this.engine.config.opt_preview !== conditions.previewParam) {\r\n          return false;\r\n        }\r\n      }\r\n      return true;\r\n    }\r\n    canRun() {\r\n      const userActiveTest = this.engine.getUserActiveTest();\r\n      if (userActiveTest && userActiveTest.testId !== this.id) {\r\n        return {\r\n          canRun: false,\r\n          reason: `user_in_other_test_${userActiveTest.testId}`,\r\n          blockedBy: userActiveTest,\r\n        };\r\n      }\r\n      if (userActiveTest && userActiveTest.testId === this.id) {\r\n        return {\r\n          canRun: true,\r\n          useExisting: true,\r\n          variation: userActiveTest.variation,\r\n        };\r\n      }\r\n      if (!this.checkConditions()) {\r\n        return { canRun: false, reason: \"conditions_not_met\" };\r\n      }\r\n      if (Math.random() > this.config.trafficPercentage) {\r\n        return { canRun: false, reason: \"traffic_percentage\" };\r\n      }\r\n      return { canRun: true, useExisting: false };\r\n    }\r\n    selectVariation() {\r\n      const selectedIndex = this.engine.weightedRandom(this.config.weights);\r\n      return this.config.versions[selectedIndex];\r\n    }\r\n    executeVariation(variationName) {\r\n      this.engine.setActiveVariation(variationName);\r\n      this.engine.pushDataLayer(variationName);\r\n      this.engine.triggerHotjar(variationName);\r\n      const variationConfig = this.config.variations[variationName];\r\n      if (variationConfig && typeof variationConfig.execute === \"function\") {\r\n        variationConfig.execute();\r\n      }\r\n    }\r\n    checkAndRun() {\r\n      const runStatus = this.canRun();\r\n      if (!runStatus.canRun) {\r\n        if (runStatus.blockedBy) {\r\n        } else {\r\n        }\r\n        return false;\r\n      }\r\n      let selectedVariation;\r\n      if (runStatus.useExisting) {\r\n        selectedVariation = runStatus.variation;\r\n      } else {\r\n        selectedVariation = this.selectVariation();\r\n      }\r\n      this.executeVariation(selectedVariation);\r\n      return true;\r\n    }\r\n  }\r\n  window.abTestEngine = new ABTestEngine();\r\n}\r\n\r\nfunction testVersionsInit(abTestEngine) {abTestEngine.registerTest({\r\n  id: \"DISC11836\",\r\n  versions: [\"DISC11836_V1\", \"DISC11836_V2\"],\r\n  weights: [50, 50],\r\n  trafficPercentage: 1,\r\n  conditions: {\r\n    loginStatus: [\"login\", \"not-login\"],\r\n    pages: [\"category-listing\"],\r\n    screenSize: \"(max-width: 990px)\",\r\n    hostname: \"www.n11.com\",\r\n    requireCookiePermit: true,\r\n    isThere: (() => {\r\n      const url = new URL(window.location.href);\r\n      return url.searchParams.has(\"promotions\");\r\n    })(),\r\n  },\r\n  variations: {\r\n    DISC11836_V1: {\r\n      execute: function () {\r\n        console.log(\"Promotions_URL_Redirect_ORG\");\r\n      },\r\n    },\r\n    DISC11836_V2: {\r\n      execute: function () {\r\n        (function () {\r\n          const currentUrl = window.location.href;\r\n          if (!/[?&]promotions=/.test(currentUrl)) {\r\n            localStorage.setItem(\"promList\", \"0\");\r\n          }\r\n\r\n          const promList = localStorage.getItem(\"promList\");\r\n          if (promList !== \"1\") {\r\n            const urlObj = new URL(currentUrl);\r\n            const promotionsValue = urlObj.searchParams.get(\"promotions\");\r\n\r\n            if (promotionsValue) {\r\n              const newUrl = `https://m.n11.com/arama?srt=REVIEWS&promotions=${promotionsValue}`;\r\n              window.location.replace(newUrl);\r\n              localStorage.setItem(\"promList\", \"1\");\r\n            }\r\n          }\r\n        })();\r\n      },\r\n    },\r\n  },\r\n});abTestEngine.registerTest({\r\n  id: \"DISC12068\",\r\n  versions: [\"DISC12068_V1\", \"DISC12068_V2\"],\r\n  weights: [50, 50],\r\n  trafficPercentage: 0.5,\r\n  conditions: {\r\n    loginStatus: [\"login\", \"not-login\"],\r\n    pages: [\"homepage\"],\r\n    screenSize: \"(max-width: 990px)\",\r\n    hostname: \"www.n11.com\",\r\n    requireCookiePermit: true,\r\n    isThere: true,\r\n  },\r\n  variations: {\r\n    DISC12068_V1: {\r\n      execute: function () {\r\n        console.log(\"DISC12068_V1_ORG\")\r\n      },\r\n    },\r\n    DISC12068_V2: {\r\n      execute: function () {\r\n        const styleEl = document.createElement(\"style\");\r\n        styleEl.textContent = `\r\n               .homePageConceptCampaign .slider-wrap {\r\n                display: flex;\r\n                flex-wrap: nowrap;\r\n                flex-direction: column;\r\n                padding: 0 0 15px 0;}\r\n            `;\r\n        document.head.appendChild(styleEl);\r\n        \r\n      },\r\n    },\r\n  },\r\n});abTestEngine.registerTest({\r\n    id: \"DISC11880\",\r\n    versions: [\"DISC11880_V1\", \"DISC11880_V2\", \"DISC11880_V3\"],\r\n    weights: [33.33, 33.33, 33.33],\r\n    trafficPercentage: 0.5,\r\n    conditions: {\r\n        loginStatus: [\"login\", \"not-login\"],\r\n        pages: [\"homepage\"],\r\n        screenSize: \"(max-width: 990px)\",\r\n        hostname: \"www.n11.com\",\r\n        requireCookiePermit: true,\r\n        isThere: true,\r\n    },\r\n    variations: {\r\n        DISC11880_V1: {\r\n            execute: function () {\r\n                console.log(\"DISC11880_V1_ORG\");\r\n                var changeBtn = document.querySelector(\"button.redirection-panel-button-container__button\");\r\n                if (changeBtn) {\r\n                    changeBtn.insertAdjacentHTML(\"afterend\", `<a href=\"https://n11.go.link?adj_t=1u9it5sc_1uzcdl0u&adj_engagement_type=fallback_click\" title=\"\" class=\"redirection-panel-button-container__button\">${changeBtn.innerText}</a>`);\r\n                    changeBtn.remove();\r\n                }\r\n                var styleEl2 = document.createElement(\"style\");\r\n                document.head.appendChild(styleEl2);\r\n                styleEl2.textContent = `\r\n        a.redirection-panel-button-container__button {\r\n            align-content: center;\r\n            background: var(--magenta-M50);\r\n            border: 1px solid var(--magenta-M50);\r\n            border-radius: 6px;\r\n            color: var(--neutral-N00);\r\n            display: flex;\r\n            font-size: 16px;\r\n            font-weight: 700;\r\n            height: 48px;\r\n            justify-content: center;\r\n            letter-spacing: -.05px;\r\n            line-height: 20px;\r\n            padding: 14px 24px;\r\n            width: 100%;    \r\n        }`;\r\n            },\r\n        },\r\n        DISC11880_V2: {\r\n            execute: function () {\r\n                var redirectionPanel = document.querySelector(\".redirection-panel\");\r\n                var bodyOverlay = document.querySelector(\"body\");\r\n                if (redirectionPanel) {\r\n                    bodyOverlay.insertAdjacentHTML(\"afterbegin\", `<div class=\"overlayBg\"></div>`);\r\n                }\r\n                var overlayBg = document.querySelector(\".overlayBg\");\r\n                var redirectionpanelclose = document.querySelector(\".redirection-panel--close\");\r\n\r\n\r\n                if (overlayBg) {\r\n                    overlayBg.addEventListener(\"click\", function () {\r\n                        redirectionpanelclose.click();\r\n                        overlayBg.remove();\r\n                    });\r\n                    redirectionpanelclose.addEventListener(\"click\", function () {\r\n                        overlayBg.remove();\r\n                    });\r\n                }\r\n                var styleEl = document.createElement(\"style\");\r\n                document.head.appendChild(styleEl);\r\n                styleEl.textContent = `\r\n        .overlayBg {\r\n            position: fixed;\r\n            top: 0;\r\n            left: 0;\r\n            width: 100%;\r\n            height: 100%;\r\n            background-color: rgba(0, 0, 0, 0.5);\r\n            z-index: 999;\r\n        }\r\n        `;\r\n\r\n\r\n                var changeBtn = document.querySelector(\"button.redirection-panel-button-container__button\");\r\n                if (changeBtn) {\r\n                    changeBtn.insertAdjacentHTML(\"afterend\", `<a href=\"https://n11.go.link?adj_t=1u9b0d73_1ud8mcj7&adj_engagement_type=fallback_click\" title=\"\" class=\"redirection-panel-button-container__button\">${changeBtn.innerText}</a>`);\r\n                    changeBtn.remove();\r\n                }\r\n                var styleEl2 = document.createElement(\"style\");\r\n                document.head.appendChild(styleEl2);\r\n                styleEl2.textContent = `\r\n        a.redirection-panel-button-container__button {\r\n            align-content: center;\r\n            background: var(--magenta-M50);\r\n            border: 1px solid var(--magenta-M50);\r\n            border-radius: 6px;\r\n            color: var(--neutral-N00);\r\n            display: flex;\r\n            font-size: 16px;\r\n            font-weight: 700;\r\n            height: 48px;\r\n            justify-content: center;\r\n            letter-spacing: -.05px;\r\n            line-height: 20px;\r\n            padding: 14px 24px;\r\n            width: 100%;    \r\n        }`;\r\n            },\r\n        },\r\n        DISC11880_V3: {\r\n            execute: function () {\r\n                var redirectionPanel = document.querySelector(\".redirection-panel\");\r\n                var bodyOverlay = document.querySelector(\"body\");\r\n                var changeButtonText = document.querySelector(\".redirection-panel-button-container__button\");\r\n                changeButtonText.textContent = \"Uygulamayı İndir\";\r\n                if (redirectionPanel) {\r\n                    bodyOverlay.insertAdjacentHTML(\"afterbegin\", `<style>.overlayBg { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5); z-index: 999; } </style><div class=\"overlayBg\"></div>`);\r\n                }\r\n                var overlayBg = document.querySelector(\".overlayBg\");\r\n                var redirectionpanelclose = document.querySelector(\".redirection-panel--close\");\r\n\r\n\r\n                if (overlayBg) {\r\n                    overlayBg.addEventListener(\"click\", function () {\r\n                        console.log('overlay');\r\n                        redirectionpanelclose.click();\r\n                        overlayBg.remove();\r\n                    });\r\n                    redirectionpanelclose.addEventListener(\"click\", function () {\r\n                        console.log('close');\r\n                        overlayBg.remove();\r\n                    });\r\n                }\r\n\r\n                var changeBtn = document.querySelector(\"button.redirection-panel-button-container__button\");\r\n                if (changeBtn) {\r\n                    changeBtn.insertAdjacentHTML(\"afterend\", `<a href=\"https://n11.go.link?adj_t=1u9vjlii_1ujhr583&adj_engagement_type=fallback_click\" title=\"\" class=\"redirection-panel-button-container__button\">${changeBtn.innerText}</a>`);\r\n                    changeBtn.remove();\r\n                }\r\n                var styleEl2 = document.createElement(\"style\");\r\n                document.head.appendChild(styleEl2);\r\n                styleEl2.textContent = `\r\n        a.redirection-panel-button-container__button {\r\n            align-content: center;\r\n            background: var(--magenta-M50);\r\n            border: 1px solid var(--magenta-M50);\r\n            border-radius: 6px;\r\n            color: var(--neutral-N00);\r\n            display: flex;\r\n            font-size: 16px;\r\n            font-weight: 700;\r\n            height: 48px;\r\n            justify-content: center;\r\n            letter-spacing: -.05px;\r\n            line-height: 20px;\r\n            padding: 14px 24px;\r\n            width: 100%;    \r\n        }`;\r\n            },\r\n        },\r\n    },\r\n});abTestEngine.registerTest({\r\n    id: \"DISC12038\",\r\n    versions: [\"DISC12038_ORG\", \"DISC12038_V1\"],\r\n    weights: [50, 50],\r\n    trafficPercentage: 1,\r\n    conditions: {\r\n        loginStatus: [\"login\"],\r\n        pages: [\"shopping-basket\"],\r\n        screenSize: \"(max-width: 990px)\",\r\n        hostname: \"www.n11.com\",\r\n        requireCookiePermit: true,\r\n        isThere: true,\r\n    },\r\n    variations: {\r\n        DISC12038_ORG: {\r\n            execute: function () {\r\n                console.log('opt-headersticky-orj')\r\n            },\r\n        },\r\n        DISC12038_V1: {\r\n            execute: function () {\r\n                (function() {\r\n                    console.log('DISC12038_V1');\r\n\r\n                    const addressAndCoupon = document.querySelector('#basketHeadWrapper .addressAndCoupon');\r\n                    const allPage = document.querySelector('#app .allPage');\r\n\r\n                    if (!addressAndCoupon || !allPage) return;\r\n\r\n                    function handleScroll() {\r\n                        const sticky = window.scrollY > 0;\r\n\r\n                        addressAndCoupon.classList.toggle('sticky', sticky);\r\n                        allPage.classList.toggle('sticky-header-active', sticky);\r\n                    }\r\n\r\n                    window.addEventListener('scroll', handleScroll);\r\n                    handleScroll();\r\n\r\n                    const styleEl = document.createElement(\"style\");\r\n                    styleEl.textContent = `\r\n                #basketHeadWrapper .addressAndCoupon.sticky {\r\n                    border-bottom: 1px solid #dedede;\r\n                    position: fixed;\r\n                    top: 50px;\r\n                    z-index: 999;\r\n                }\r\n                #app .allPage.sticky-header-active {\r\n                    padding-top: 72px;\r\n                }\r\n            `;\r\n                    document.head.appendChild(styleEl);\r\n                })();\r\n            },\r\n        },\r\n    },\r\n});}\r\n\r\nfunction footerTestInit(abTestEngine) {\r\n  // ====== FOOTER TEST ======\r\n  abTestEngine.clearAllTests = function () {\r\n    this.clearCookie(\"Optimization\");\r\n    this.activeCookie = \"\";\r\n  };\r\n  abTestEngine.showUserStatus = function () {\r\n    const activeTest = this.getUserActiveTest();\r\n    if (activeTest) {\r\n    } else {\r\n    }\r\n    return activeTest;\r\n  };\r\n  abTestEngine.showUserStatus();\r\n  if (!abTestEngine.config.isCookiePermit) {\r\n    return;\r\n  }\r\n  abTestEngine.runTests();\r\n  abTestEngine.showUserStatus();\r\n}\r\n\r\nfunction getLastMarketing() {\r\n  return window.dataLayer?.filter((item) => item.categories).at(-1)?.categories?.marketing;\r\n}\r\n\r\nlet testFunctionCalled = false;\r\n\r\nfunction callTestFunction() {\r\n  if (testFunctionCalled) return;\r\n\r\n  testFunctionCalled = true;\r\n\r\n  setTimeout(() => {\r\n    masterTestEngineInit();\r\n    testVersionsInit(window.abTestEngine);\r\n    footerTestInit(window.abTestEngine);\r\n  }, 1000);\r\n}\r\n\r\nif (getLastMarketing()) {\r\n  callTestFunction();\r\n} else {\r\n  const observer = new MutationObserver(() => {\r\n    const host = document.querySelector(\"efilli-layout-dynamic\");\r\n    const shadow = host?.shadowRoot;\r\n    const acceptBtn = shadow?.querySelector('[data-name=\"Accept Button\"]');\r\n\r\n    if (acceptBtn) {\r\n      observer.disconnect();\r\n      acceptBtn.addEventListener(\"click\", () => {\r\n        if (getLastMarketing()) {\r\n          callTestFunction();\r\n        }\r\n      });\r\n    }\r\n  });\r\n\r\n  observer.observe(document.body, { childList: true, subtree: true });\r\n}\r\nconsole.log(\"footer-frontend\");\r\nsetTimeout(() => {\r\n  (function () {\r\n    function getQueryParam(name) {\r\n      const url = new URL(window.location.href);\r\n      return url.searchParams.get(name);\r\n    }\r\n    const testParam = getQueryParam(\"testpreview\");\r\n    if (testParam && localStorage.getItem(\"abtest_preview_code\")) {\r\n      try {\r\n        const code = localStorage.getItem(\"abtest_preview_code\");\r\n        // eslint-disable-next-line no-eval\r\n        eval(code);\r\n      } catch (e) {\r\n        console.error(\"ABTest Preview kodu çalıştırılamadı:\", e);\r\n      }\r\n    }\r\n  })();\r\n}, 10);", "seoCmsHtmlContent": "", "inventoryLocationForSeo": "footer-optimization-script"}}